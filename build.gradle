plugins {
    id "org.springframework.boot" version "3.4.5" apply false
    id "io.spring.dependency-management" version "1.1.7" apply false

}

subprojects {
    apply plugin: 'java'
    apply plugin: 'io.spring.dependency-management'

    dependencyManagement {
        imports {
            mavenBom "org.springframework.boot:spring-boot-dependencies:3.4.5"
        }
    }

    group = "com.icc.qasker"
    version = "1.3.1"
    sourceCompatibility = '17'

    configurations {
        compileOnly {
            extendsFrom annotationProcessor
        }
    }

    repositories {
        mavenCentral()
    }

    dependencies {
        // ────────────────────────────────
        // Spring Boot 기본 구성
        // ────────────────────────────────
        implementation "org.springframework.boot:spring-boot-starter"
        implementation "org.springframework.boot:spring-boot-starter-web"
        implementation "org.springframework.boot:spring-boot-starter-actuator"
        implementation "org.springframework.boot:spring-boot-starter-data-jpa"
        implementation "org.springframework.boot:spring-boot-starter-data-redis"
        implementation "org.springframework.boot:spring-boot-starter-webflux"
        testImplementation "org.springframework.boot:spring-boot-starter-test"
        testRuntimeOnly "org.junit.platform:junit-platform-launcher"

        // ────────────────────────────────
        // AWS SDK
        // ────────────────────────────────
        implementation platform("software.amazon.awssdk:bom:2.27.24")
        implementation "software.amazon.awssdk:s3"

        // ────────────────────────────────
        // 로깅 및 모니터링
        // ────────────────────────────────
        implementation "com.github.maricn:logback-slack-appender:1.6.1"
        implementation "com.newrelic.agent.java:newrelic-api:8.11.0"
        implementation 'org.codehaus.janino:janino:3.1.12'

        // ────────────────────────────────
        // 데이터베이스 및 JDBC
        // ────────────────────────────────
        runtimeOnly "com.mysql:mysql-connector-j"

        // ────────────────────────────────
        // 문서 변환 (PDF 등)
        // ────────────────────────────────
        implementation "org.jodconverter:jodconverter-local-lo:4.4.9"

        // ────────────────────────────────
        // API 문서 (Swagger / OpenAPI)
        // ────────────────────────────────
        implementation "org.springdoc:springdoc-openapi:2.3.0"
        implementation "org.springdoc:springdoc-openapi-starter-webmvc-ui:2.8.8"

        // ────────────────────────────────
        // 인증 및 JWT
        // ────────────────────────────────
        implementation "org.springframework.boot:spring-boot-starter-oauth2-client"
        implementation "com.auth0:java-jwt:4.5.0"

        // ────────────────────────────────
        // 기타 유틸리티
        // ────────────────────────────────
        implementation "org.hashids:hashids:1.0.3"

        // ────────────────────────────────
        // Lombok
        // ────────────────────────────────
        compileOnly "org.projectlombok:lombok"
        annotationProcessor "org.projectlombok:lombok"
    }

    test { useJUnitPlatform() }

    tasks.withType(Jar).configureEach {
        duplicatesStrategy = DuplicatesStrategy.FAIL
    }

}